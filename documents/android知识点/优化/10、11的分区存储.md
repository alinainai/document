### 1. Android Q 开始的分区存储

在Android使用 fuse 文件系统开始，Android针对外置存储支持了独立的沙箱存储空间，一般通过Context.getExternalFilesDir() Api 获取，该空间内的数据为应用独有，并且不需要申请任何权限即可使用。
但是当时并没有限制应用读写非沙箱内的数据。从Android Q开始，出于数据隐私问题，Android 希望禁止应用程序操作非沙箱内的数据。为了过度，Android提供了requestLegacyExternalStorage机制，来帮助应用使用原来的机制继续读写存储卡。
Android 应用程序即使获取了读写存储卡权限也不能读写非沙盒路径下的数据。除非Android 应用程序获得读写存储卡权限的情况下，必须在 AndroidManifest.xml 的 application 标签下声明 requestLegacyExternalStorage=true，才可以访问非沙盒路径下的数据。
targetSdkVersion < 29 的应用程序默认带有requestLegacyExternalStorage=true属性。

### 2. Androd 11 无效的 requestLegacyExternalStorage=true

当targetSdk 升级到 30 之后，requestLegacyExternalStorage=true 无效，所以必须适配。


### 参考

[Android 10 中的隐私权变更](https://developer.android.com/about/versions/10/privacy/changes?hl=zh-cn#scoped-storage)
[Android 11 中的存储机制更新](https://developer.android.com/about/versions/11/privacy/storage)

